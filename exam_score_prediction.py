# -*- coding: utf-8 -*-
"""Exam Score Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1lCyAuz04nOQPpFZ7pDmtet4_V-bbON_z
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
warnings.filterwarnings("ignore")

df=pd.read_csv("student_habits_performance.csv");

df.head()





df.info();

sns.set(style="whitegrid");

df.info();

df.dropna(inplace=True)

df.info()

df.isna()

df.describe()

df.describe(include="object").columns

categorical_columns=[ 'gender', 'part_time_job', 'diet_quality',
       'parental_education_level', 'internet_quality',
       'extracurricular_participation']

for col in categorical_columns:
    print(f'Value count for {col}:\n {df[col].value_counts()}')

df.hist(bins=20, figsize=(10,10));

for cols in categorical_columns:
    sns.countplot(x=cols, data=df);
    plt.title(f'Distribution for  {cols}');
    plt.xticks(rotation=45);
    plt.show();





sns.heatmap(df.corr(numeric_only=True),annot=True,cmap="coolwarm",fmt=".2f");
plt.title(f'Correlation Matrix');
plt.show();
plt.xticks(rotation=45);
plt.show();

df.describe().columns
numeric_feactures=['age', 'study_hours_per_day', 'social_media_hours', 'netflix_hours',
       'attendance_percentage', 'sleep_hours', 'exercise_frequency',
       'mental_health_rating']

for cols in numeric_feactures:
    sns.scatterplot(x=cols, data=df, y="exam_score");
    plt.title(f'{cols} v/s Exam_score');

    plt.show();
#

for cols in categorical_columns:
    sns.boxplot(x=cols, data=df, y="exam_score");
    plt.title(f'{cols} v/s Exam_score');

    plt.show();

from sklearn.preprocessing import LabelEncoder
from sklearn.model_selection import train_test_split, GridSearchCV
from sklearn.linear_model import LinearRegression,Ridge
from sklearn.metrics import mean_squared_error, r2_score
from sklearn.tree import DecisionTreeRegressor
from sklearn.ensemble import RandomForestRegressor
from sklearn.svm import SVR

feature=['study_hours_per_day','attendance_percentage', 'sleep_hours','mental_health_rating','part_time_job']
target="exam_score"



df_model=df[feature+[target]].copy()

df_model.head()

le = LabelEncoder()
df_model['part_time_job'] = le.fit_transform(df_model['part_time_job'])

X = df_model[feature]
y = df_model[target]

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

print("Shape of X_train:", X_train.shape)
print("Shape of X_test:", X_test.shape)
print("Shape of y_train:", y_train.shape)
print("Shape of y_test:", y_test.shape)

models = {
    "Linear Regression": {
        "model": LinearRegression(),
        "params": {}
    },

    "Decision Tree":{
        "model":DecisionTreeRegressor(),
        "params":{"max_depth":[3,5,10],"min_samples_split":[2,5]}
    },
    "Random Forest":{
        "model":RandomForestRegressor(),
        "params":{"n_estimators":[50,100],"max_depth":[5,10]}
    }

}

best_models=[];

for names,config in models.items():
    print(f"Training {names} model");
    grid=GridSearchCV(config["model"],config["params"],cv=5,scoring="neg_mean_squared_error");
    grid.fit(X_train,y_train)
    y_predicte=grid.predict(X_test)
    rmse= np.sqrt(mean_squared_error(y_test,y_predicte))
    r2=r2_score(y_test,y_predicte)

    best_models.append({
        "model_name":names,
        "best_params":grid.best_params_,
        "rmse":rmse,
        "r2":r2
    })

best_models
result_df=pd.DataFrame(best_models)

result_df.sort_values(by="rmse")

best_row=result_df.sort_values(by="rmse").iloc[0]

best_row

best_model_name=best_row["model_name"]

best_model_name

best_model_config=models[best_model_name]

best_model_name

final_model=best_model_config["model"]
final_model.fit(X_train,y_train)

import joblib
joblib.dump(final_model,"student_performance_model.pkl")

joblib.load("student_performance_model.pkl").predict(X_test)

!pip install streamlit
import streamlit as st
import numpy as np
import joblib

import streamlit as st
model=joblib.load("student_performance_model.pkl")

st.title("Student Performance Prediction")

study_hours = st.slider("Study Hours per Day", 0.0, 12.0, 2.0)
attendance = st.slider("Attendance Percentage", 0.0, 100.0, 80.0)
sleep_hours = st.slider("Sleep Hours per Night", 0.0, 12.0, 7.0)
mental_health = st.slider("Mental Health (1‚Äì10)", 1, 10, 5)
part_time_job = st.selectbox("Part-Time Job", ["Yes", "No"])

import ipywidgets as widgets
from IPython.display import display

# Create sliders
study_hours = widgets.FloatSlider(
    value=10.0,
    min=0.0,
    max=12.0,
    step=0.5,
    description='Study Hours'
)

attendance = widgets.FloatSlider(
    value=10.0,
    min=0.0,
    max=100.0,
    step=1.0,
    description='Attendance %'
)

sleep_hours = widgets.FloatSlider(
    value=7.0,
    min=0.0,
    max=12.0,
    step=0.5,
    description='Sleep Hours'
)

mental_health = widgets.IntSlider(
    value=5,
    min=1,
    max=10,
    description='Mental Health'
)

part_time_job = widgets.Dropdown(
    options=['No', 'Yes'],
    value='No',
    description='Part-Time'
)

# Display sliders
display(study_hours, attendance, sleep_hours, mental_health,part_time_job)

predict_btn = widgets.Button(
    description="Predict Performance",
    button_style="success"
)

output = widgets.Output()

def predict(b):
    with output:
        output.clear_output()

        # Convert Part-Time Job to numeric
        part_time_val = 1 if part_time_job.value == 'Yes' else 0

        # Include all 5 features
        input_data = np.array([[
            study_hours.value,
            attendance.value,
            sleep_hours.value,
            mental_health.value,
            part_time_val
        ]])

        prediction = model.predict(input_data)[0]

        print("üéØ Predicted Score:", round(prediction, 2))

        if prediction >= 75:
            print("üèÜ Performance: Excellent")
        elif prediction >= 60:
            print("‚úÖ Performance: Good")
        else:
            print("‚ö†Ô∏è Performance: Needs Improvement")

predict_btn.on_click(predict)

display(predict_btn, output)